# Bharat AI-SoC Project: Road Anomaly Detection

## Project Overview
This project detects road anomalies such as **potholes, bumps, and cracks** in videos using a YOLO-based **ONNX model**.  
The system is deployed on a **Raspberry Pi 4** and can process pre-recorded videos to highlight anomalies with bounding boxes, confidence scores, and FPS information.  

The project demonstrates a complete end-to-end pipeline:
- Preprocessing video frames
- Running inference on a YOLO model
- Post-processing with class-specific thresholds and pothole filtering
- Annotating frames with bounding boxes, labels, timestamp, and FPS
- Generating output videos showing detected anomalies


## Folder Structure
ARM_Project/
├── datasets/ # Input test videos
│ ├── pothole_test.mp4
│ └── test_video.mp4
├── Demo_video/ # Mobile-recorded demo of Raspberry Pi running
│ └── Bharat_Soc_Challenge_demo_video.mp4
├── Final_output/ # Output video generated by Raspberry Pi
│ └── output.mp4
├── model/ # Trained ONNX model
│ └── best.onnx
├── scripts/ # Scripts for testing custom videos
│ └── test_video(s).py
├── src/ # Modular Python code
│ ├── inference.py
│ ├── postprocess.py
│ ├── preprocess.py
│ └── utils.py
├── main.py # Entry point for running the system
├── Technical Report/ # Project report
│ └── report.pdf
└── requirements.txt # Python dependencies

## Videos Included

1. **Input videos** – `datasets/pothole_test.mp4`, `datasets/test_1.mp4`  
   - Pre-recorded test videos used as input for the system.  

2. **Output video** – `Final_output/output.mp4`  
   - Generated by Raspberry Pi 4. Shows bounding boxes, confidence scores, timestamp, and FPS (~6 FPS on Pi).  

3. **Demo video** – `Demo_video/Bharat_Soc_Challenge_demo_video.mp4`  
   - A mobile-recorded video showing real-time Raspberry Pi demo.  

> **Note:** Laptop testing achieves ~14–17 FPS, but this does not reflect actual deployment performance on Raspberry Pi.

---

## How to Run

### 1. Run the default test video:

```bash
python3 main.py

### Dependencies

1.Python 3.x

2.OpenCV (opencv-python)

3.NumPy (numpy)

4.ONNX Runtime (onnxruntime)

### Install required packages via pip:

pip install -r requirements.txt

### Project Features:

* YOLO-based ONNX model for road anomaly detection

* Modular code for preprocessing, inference, and post-processing

* Class-specific confidence thresholds and filtering for potholes

* Bounding boxes, confidence labels, timestamp, and FPS overlay on output video

* Real-time demo captured from Raspberry Pi 4

* Fully relative paths for easy repository cloning 

### Author's

Paul Rojer R 
Brindha S
Sriram A